<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>CEO Visibility Dashboard</title>
    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React 18 + ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for in-browser JSX transform -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // Simple emoji/icon helpers (no external icon package needed)
      const StatusPill = ({ status }) => {
        const map = {
          green: { text: "On track", cls: "text-green-600 bg-green-100", emoji: "üü¢" },
          yellow:{ text: "At risk",  cls: "text-yellow-600 bg-yellow-100", emoji: "üü°" },
          red:   { text: "Off track",cls: "text-red-600 bg-red-100", emoji: "üî¥" }
        };
        const s = map[status] || { text: "Unknown", cls: "text-gray-600 bg-gray-100", emoji: "‚è±Ô∏è" };
        return (
          <span className={`px-2 py-1 rounded-full flex items-center gap-1 text-sm font-medium ${s.cls}`}>
            <span>{s.emoji}</span><span className="capitalize">{status}</span>
          </span>
        );
      };

      function CEODashboard() {
        // Initial departments (now includes Mariam - Human Resources)
        const initialDepartments = [
          { id: 'ops', name: 'Operations', manager: 'Jagan', status: 'green',
            keyMetrics: { efficiency: 0, tasksCompleted: 0, onTimeDelivery: 0, qualityScore: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'clinical', name: 'Clinical Operations', manager: 'Betty', status: 'green',
            keyMetrics: { patientSatisfaction: 0, clinicalAccuracy: 0, processCompliance: 0, turnaroundTime: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'globalfund', name: 'Global Fund', manager: 'Nafi', status: 'green',
            keyMetrics: { fundingSecured: 0, proposalsSubmitted: 0, complianceScore: 0, reportingTimeliness: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'retail', name: 'Retail', manager: 'Mabinta', status: 'green',
            keyMetrics: { salesGrowth: 0, inventoryTurnover: 0, customerSatisfaction: 0, storePerformance: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'subscription', name: 'Subscription', manager: 'Lena', status: 'green',
            keyMetrics: { monthlyRecurringRevenue: 0, churnRate: 0, customerAcquisition: 0, retentionRate: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'finance', name: 'Finance', manager: 'Yusupha', status: 'green',
            keyMetrics: { budgetVariance: 0, cashFlow: 0, accountsReceivable: 0, costReduction: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },

          <!-- ‚úÖ New Department -->
          { id: 'hr', name: 'Human Resources', manager: 'Mariam', status: 'green',
            keyMetrics: { retentionRate: 0, timeToHire: 0, trainingCompletion: 0, engagementScore: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },

          { id: 'srops', name: 'Senior Operations', manager: 'Vic', status: 'green',
            keyMetrics: { strategicGoals: 0, crossTeamCollaboration: 0, processOptimization: 0, leadershipScore: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'technology', name: 'Technology', manager: 'Kendesoft', status: 'green',
            keyMetrics: { systemUptime: 0, bugResolution: 0, projectDelivery: 0, innovationIndex: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
          { id: 'logistics', name: 'Logistics', manager: 'Modou', status: 'green',
            keyMetrics: { deliveryAccuracy: 0, warehouseEfficiency: 0, transportCost: 0, orderFulfillment: 0 },
            projects: [], blockers: [], weeklyUpdate: { wins:'',challenges:'',nextWeek:'',date: new Date().toISOString().split('T')[0] } },
        ];

        // State
        const [departments, setDepartments] = useState(() => {
          try {
            const saved = localStorage.getItem('ceoDashboardData');
            return saved ? JSON.parse(saved) : initialDepartments;
          } catch { return initialDepartments; }
        });
        const [viewMode, setViewMode] = useState('overview'); // overview | details | updates | monthly
        const [selectedDept, setSelectedDept] = useState(null);
        const [editMode, setEditMode] = useState(false);
        const [newProject, setNewProject] = useState({ name:'', deadline:'', status:'green', completion:0 });
        const [showModal, setShowModal] = useState(false);
        const [history, setHistory] = useState(() => {
          try {
            const saved = localStorage.getItem('updateHistory');
            return saved ? JSON.parse(saved) : [];
          } catch { return []; }
        });
        const [selectedMonth, setSelectedMonth] = useState(new Date().toISOString().slice(0,7));

        // Persist
        useEffect(()=> localStorage.setItem('ceoDashboardData', JSON.stringify(departments)), [departments]);
        useEffect(()=> localStorage.setItem('updateHistory', JSON.stringify(history)), [history]);

        const updateDeptStatus = (id, status) => {
          setDepartments(prev => prev.map(d => d.id===id ? { ...d, status } : d));
        };

        const updateMetric = (id, key, value) => {
          const num = Number.isNaN(parseFloat(value)) ? 0 : parseFloat(value);
          setDepartments(prev => prev.map(d => d.id===id ? { ...d, keyMetrics: { ...d.keyMetrics, [key]: num } } : d));
        };

        const updateWeekly = (id, field, value) => {
          setDepartments(prev => prev.map(d => d.id===id ? {
            ...d,
            weeklyUpdate: { ...d.weeklyUpdate, [field]: value, date: new Date().toISOString().split('T')[0] }
          } : d));
          setHistory(h => [...h, { deptId: id, date: new Date().toISOString(), type:'weekly_update', field, value }]);
        };

        const addProject = (deptId) => {
          if (!newProject.name.trim()) return;
          setDepartments(prev => prev.map(d => d.id===deptId ? {
            ...d,
            projects: [...d.projects, { ...newProject, id: Date.now() }]
          } : d));
          setNewProject({ name:'', deadline:'', status:'green', completion:0 });
          setShowModal(false);
        };

        const updateProject = (deptId, projectId, field, value) => {
          setDepartments(prev => prev.map(d => d.id===deptId ? {
            ...d,
            projects: d.projects.map(p => p.id===projectId
              ? { ...p, [field]: field==='completion' ? Math.min(100, Math.max(0, parseInt(value||0,10))) : value }
              : p)
          } : d));
        };

        const deleteProject = (deptId, projectId) => {
          setDepartments(prev => prev.map(d => d.id===deptId ? {
            ...d, projects: d.projects.filter(p => p.id!==projectId)
          } : d));
        };

        const addBlocker = (deptId, text) => {
          if (!text.trim()) return;
          setDepartments(prev => prev.map(d => d.id===deptId ? {
            ...d, blockers: [...d.blockers, { id: Date.now(), text, date: new Date().toISOString() }]
          } : d));
        };

        const removeBlocker = (deptId, blockerId) => {
          setDepartments(prev => prev.map(d => d.id===deptId ? {
            ...d, blockers: d.blockers.filter(b => b.id !== blockerId)
          } : d));
        };

        const monthlySnapshot = () => {
          const monthData = history.filter(h => h.date.startsWith(selectedMonth));
          return departments.map(d => {
            const deptUpdates = monthData.filter(u => u.deptId === d.id);
            const total = d.projects.length;
            const completed = d.projects.filter(p => (p.completion||0) === 100).length;
            const avg = total>0 ? Math.round(d.projects.reduce((s,p)=>s+(p.completion||0),0)/total) : 0;
            return { ...d, monthlyStats:{ updates: deptUpdates.length, projectsTotal: total, projectsCompleted: completed, avgCompletion: avg, blockerCount: d.blockers.length } };
          });
        };

        // Header stats
        const onTrack = departments.filter(d=>d.status==='green').length;
        const atRisk  = departments.filter(d=>d.status==='yellow').length;
        const offTrack= departments.filter(d=>d.status==='red').length;
        const blockers= departments.reduce((s,d)=>s+d.blockers.length,0);
        const projects= departments.reduce((s,d)=>s+d.projects.length,0);

        return (
          <div className="min-h-screen p-4 md:p-6">
            <div className="max-w-7xl mx-auto">
              {/* Header */}
              <div className="bg-white rounded-lg shadow-sm p-6 mb-6">
                <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                  <div>
                    <h1 className="text-2xl md:text-3xl font-bold text-gray-900">CEO Visibility Dashboard</h1>
                    <p className="text-gray-600 mt-2">High-level view of priorities, blockers, and momentum</p>
                  </div>
                  <div className="flex flex-wrap gap-2">
                    {['overview','details','updates','monthly'].map(mode => (
                      <button key={mode}
                        onClick={()=> setViewMode(mode)}
                        className={`px-4 py-2 rounded-lg font-medium transition-colors ${viewMode===mode?'bg-blue-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}
                        {...(mode==='details' && !selectedDept ? {disabled:true, title:'Select a department from Overview first'} : {})}
                      >
                        {mode==='overview' && 'Overview'}
                        {mode==='details'  && 'Details'}
                        {mode==='updates'  && 'Weekly Updates'}
                        {mode==='monthly'  && 'Monthly Snapshot'}
                      </button>
                    ))}
                  </div>
                </div>

                {/* Quick stats */}
                <div className="grid grid-cols-2 md:grid-cols-5 gap-3 mt-6">
                  <div className="bg-green-50 rounded-lg p-3">
                    <div className="flex items-center justify-between">
                      <span className="text-green-900 font-medium text-sm">On Track</span>
                      <span className="text-xl font-bold text-green-600">{onTrack}</span>
                    </div>
                  </div>
                  <div className="bg-yellow-50 rounded-lg p-3">
                    <div className="flex items-center justify-between">
                      <span className="text-yellow-900 font-medium text-sm">At Risk</span>
                      <span className="text-xl font-bold text-yellow-600">{atRisk}</span>
                    </div>
                  </div>
                  <div className="bg-red-50 rounded-lg p-3">
                    <div className="flex items-center justify-between">
                      <span className="text-red-900 font-medium text-sm">Off Track</span>
                      <span className="text-xl font-bold text-red-600">{offTrack}</span>
                    </div>
                  </div>
                  <div className="bg-blue-50 rounded-lg p-3">
                    <div className="flex items-center justify-between">
                      <span className="text-blue-900 font-medium text-sm">Blockers</span>
                      <span className="text-xl font-bold text-blue-600">{blockers}</span>
                    </div>
                  </div>
                  <div className="bg-purple-50 rounded-lg p-3">
                    <div className="flex items-center justify-between">
                      <span className="text-purple-900 font-medium text-sm">Projects</span>
                      <span className="text-xl font-bold text-purple-600">{projects}</span>
                    </div>
                  </div>
                </div>
              </div>

              {/* Overview cards */}
              {viewMode==='overview' && (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  {departments.map(dept => (
                    <div key={dept.id} className="bg-white rounded-lg shadow-sm p-5 hover:shadow-md transition-shadow">
                      <div className="flex justify-between items-start mb-4">
                        <div>
                          <h3 className="text-lg font-semibold text-gray-900">{dept.name}</h3>
                          <p className="text-sm text-gray-600">{dept.manager}</p>
                        </div>
                        <StatusPill status={dept.status}/>
                      </div>

                      {/* Projects preview */}
                      {dept.projects.length>0 ? (
                        <div className="space-y-2 mb-4">
                          {dept.projects.slice(0,2).map(p=>(
                            <div key={p.id} className="flex items-center justify-between">
                              <span className="text-sm text-gray-700 truncate max-w-[60%]">{p.name}</span>
                              <div className="flex items-center gap-2">
                                <div className="w-16 bg-gray-200 rounded-full h-1.5">
                                  <div className={`h-1.5 rounded-full ${p.status==='green'?'bg-green-500':p.status==='yellow'?'bg-yellow-500':'bg-red-500'}`} style={{width:`${p.completion}%`}}></div>
                                </div>
                                <span className="text-xs text-gray-600">{p.completion}%</span>
                              </div>
                            </div>
                          ))}
                          {dept.projects.length>2 && <p className="text-xs text-gray-500">+{dept.projects.length-2} more projects</p>}
                        </div>
                      ) : <p className="text-sm text-gray-500 mb-4">No active projects</p>}

                      {/* Blocker preview */}
                      {dept.blockers.length>0 && (
                        <div className="bg-red-50 rounded-lg p-3 mb-3">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="text-red-600">‚ùó</span>
                            <span className="text-sm font-medium text-red-900">
                              {dept.blockers.length} Blocker{dept.blockers.length>1?'s':''}
                            </span>
                          </div>
                          <p className="text-xs text-red-800 truncate">{dept.blockers[0].text}</p>
                        </div>
                      )}

                      <div className="flex items-center justify-between text-xs text-gray-500">
                        <span>Last update: {dept.weeklyUpdate.date}</span>
                        <button
                          onClick={()=>{ setSelectedDept(dept); setViewMode('details'); }}
                          className="text-blue-600 hover:text-blue-700 font-medium"
                        >View ‚Üí</button>
                      </div>
                    </div>
                  ))}
                </div>
              )}

              {/* Details view */}
              {viewMode==='details' && selectedDept && (
                <div className="bg-white rounded-lg shadow-sm p-6">
                  <div className="flex justify-between items-start mb-6">
                    <div>
                      <h2 className="text-2xl font-bold text-gray-900">{selectedDept.name}</h2>
                      <p className="text-gray-600">Manager: {selectedDept.manager}</p>
                    </div>
                    <div className="flex items-center gap-2">
                      <button onClick={()=> setEditMode(m=>!m)}
                        className={`px-3 py-1.5 rounded-lg font-medium ${editMode?'bg-green-600 text-white':'bg-gray-100 text-gray-700'}`}>
                        {editMode ? 'Save' : 'Edit'}
                      </button>
                      <select
                        value={selectedDept.status}
                        onChange={(e)=> updateDeptStatus(selectedDept.id, e.target.value)}
                        className="px-4 py-2 rounded-lg font-medium border-2"
                      >
                        <option value="green">üü¢ On Track</option>
                        <option value="yellow">üü° At Risk</option>
                        <option value="red">üî¥ Off Track</option>
                      </select>
                    </div>
                  </div>

                  {/* Key metrics */}
                  <div className="mb-6">
                    <h3 className="text-lg font-semibold text-gray-900 mb-4">Key Metrics</h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      {Object.entries(selectedDept.keyMetrics).map(([k,v])=>(
                        <div key={k} className="bg-gray-50 rounded-lg p-4">
                          <p className="text-sm text-gray-600 capitalize mb-1">{k.replace(/([A-Z])/g,' $1').trim()}</p>
                          {editMode ? (
                            <input type="number" value={v}
                              onChange={(e)=> updateMetric(selectedDept.id, k, e.target.value)}
                              className="w-full px-2 py-1 border rounded"/>
                          ) : (
                            <p className="text-2xl font-bold text-gray-900">{v || 0}</p>
                          )}
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Projects */}
                  <div className="mb-6">
                    <div className="flex justify-between items-center mb-4">
                      <h3 className="text-lg font-semibold text-gray-900">Projects</h3>
                      {editMode && (
                        <button onClick={()=> setShowModal(true)} className="px-3 py-1.5 bg-blue-600 text-white rounded-lg font-medium">
                          + Add Project
                        </button>
                      )}
                    </div>

                    {selectedDept.projects.length>0 ? (
                      <div className="space-y-3">
                        {selectedDept.projects.map(p=>(
                          <div key={p.id} className="border rounded-lg p-4">
                            <div className="flex justify-between items-start mb-2">
                              {editMode ? (
                                <input type="text" value={p.name}
                                  onChange={(e)=> updateProject(selectedDept.id, p.id, 'name', e.target.value)}
                                  className="font-medium text-gray-900 px-2 py-1 border rounded flex-1 mr-2"/>
                              ) : (
                                <h4 className="font-medium text-gray-900">{p.name}</h4>
                              )}
                              <div className="flex items-center gap-2">
                                {editMode ? (
                                  <select value={p.status}
                                    onChange={(e)=> updateProject(selectedDept.id, p.id, 'status', e.target.value)}
                                    className="px-2 py-1 rounded text-xs font-medium border">
                                    <option value="green">Green</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="red">Red</option>
                                  </select>
                                ) : (
                                  <StatusPill status={p.status}/>
                                )}
                                {editMode && (
                                  <button onClick={()=> deleteProject(selectedDept.id, p.id)} className="text-red-600 hover:text-red-700 text-sm">Delete</button>
                                )}
                              </div>
                            </div>
                            <div className="flex items-center gap-4">
                              <div className="flex-1">
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                  <div className={`${p.status==='green'?'bg-green-500':p.status==='yellow'?'bg-yellow-500':'bg-red-500'} h-2 rounded-full`} style={{width:`${p.completion}%`}}></div>
                                </div>
                              </div>
                              {editMode ? (
                                <input type="number" min="0" max="100" value={p.completion}
                                  onChange={(e)=> updateProject(selectedDept.id, p.id, 'completion', e.target.value)}
                                  className="w-16 px-2 py-1 border rounded text-sm"/>
                              ) : (
                                <span className="text-sm text-gray-600">{p.completion}%</span>
                              )}
                              <span className="text-sm text-gray-600">Due: {p.deadline || 'TBD'}</span>
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : <p className="text-gray-500">No projects added yet</p>}
                  </div>

                  {/* Blockers */}
                  <div className="mb-6">
                    <h3 className="text-lg font-semibold text-gray-900 mb-4">Blockers & Escalations</h3>
                    <div className="space-y-2">
                      {selectedDept.blockers.map(b => (
                        <div key={b.id} className="flex items-start gap-2 bg-red-50 p-3 rounded-lg">
                          <span className="mt-0.5">üö®</span>
                          <span className="flex-1 text-sm text-red-900">{b.text}</span>
                          <button onClick={()=> removeBlocker(selectedDept.id, b.id)} className="text-red-600 hover:text-red-700 text-sm">Resolve</button>
                        </div>
                      ))}
                      <div className="flex gap-2">
                        <input type="text" placeholder="Add new blocker..." className="flex-1 px-3 py-2 border rounded-lg"
                          onKeyDown={(e)=> { if(e.key==='Enter'){ addBlocker(selectedDept.id, e.currentTarget.value); e.currentTarget.value=''; }}}/>
                      </div>
                    </div>
                  </div>

                  <button onClick={()=> setSelectedDept(null)} className="text-blue-600 hover:text-blue-700 font-medium">‚Üê Back to Overview</button>

                  {/* Modal: Add project */}
                  {showModal && (
                    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                      <div className="bg-white rounded-lg p-6 w-96">
                        <h3 className="text-lg font-semibold mb-4">Add New Project</h3>
                        <input className="w-full px-3 py-2 border rounded-lg mb-3" placeholder="Project name"
                          value={newProject.name} onChange={e=> setNewProject({...newProject, name:e.target.value})}/>
                        <input type="date" className="w-full px-3 py-2 border rounded-lg mb-3"
                          value={newProject.deadline} onChange={e=> setNewProject({...newProject, deadline:e.target.value})}/>
                        <select className="w-full px-3 py-2 border rounded-lg mb-3"
                          value={newProject.status} onChange={e=> setNewProject({...newProject, status:e.target.value})}>
                          <option value="green">üü¢ On Track</option>
                          <option value="yellow">üü° At Risk</option>
                          <option value="red">üî¥ Off Track</option>
                        </select>
                        <input type="number" min="0" max="100" className="w-full px-3 py-2 border rounded-lg mb-4"
                          placeholder="Completion %" value={newProject.completion}
                          onChange={e=> setNewProject({...newProject, completion: Math.min(100, Math.max(0, parseInt(e.target.value||0,10)))})}/>
                        <div className="flex gap-2">
                          <button className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium"
                            onClick={()=> addProject(selectedDept.id)}>Add Project</button>
                          <button className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium"
                            onClick={()=> setShowModal(false)}>Cancel</button>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              )}

              {/* Weekly updates */}
              {viewMode==='updates' && (
                <div className="space-y-4">
                  {departments.map(d => (
                    <div key={d.id} className="bg-white rounded-lg shadow-sm p-6">
                      <div className="flex justify-between items-start mb-4">
                        <div>
                          <h3 className="text-xl font-semibold text-gray-900">{d.name}</h3>
                          <p className="text-sm text-gray-600">{d.manager} ‚Ä¢ {d.weeklyUpdate.date}</p>
                        </div>
                        <StatusPill status={d.status}/>
                      </div>

                      <div className="space-y-4">
                        <div>
                          <h4 className="font-medium text-green-700 mb-1">‚úÖ Wins This Week</h4>
                          <textarea rows="2" className="w-full px-3 py-2 border rounded-lg text-gray-700"
                            value={d.weeklyUpdate.wins}
                            onChange={(e)=> updateWeekly(d.id, 'wins', e.target.value)}
                            placeholder="Enter this week's wins..."></textarea>
                        </div>
                        <div>
                          <h4 className="font-medium text-yellow-700 mb-1">‚ö†Ô∏è Challenges</h4>
                          <textarea rows="2" className="w-full px-3 py-2 border rounded-lg text-gray-700"
                            value={d.weeklyUpdate.challenges}
                            onChange={(e)=> updateWeekly(d.id, 'challenges', e.target.value)}
                            placeholder="Enter challenges faced..."></textarea>
                        </div>
                        <div>
                          <h4 className="font-medium text-blue-700 mb-1">‚û°Ô∏è Next Week Focus</h4>
                          <textarea rows="2" className="w-full px-3 py-2 border rounded-lg text-gray-700"
                            value={d.weeklyUpdate.nextWeek}
                            onChange={(e)=> updateWeekly(d.id, 'nextWeek', e.target.value)}
                            placeholder="Enter next week's focus areas..."></textarea>
                        </div>

                        {d.blockers.length>0 && (
                          <div className="bg-red-50 rounded-lg p-3">
                            <h4 className="font-medium text-red-900 mb-2">üö® Active Blockers ({d.blockers.length})</h4>
                            {d.blockers.map(b => <p key={b.id} className="text-sm text-red-800">‚Ä¢ {b.text}</p>)}
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
              )}

              {/* Monthly snapshot */}
              {viewMode==='monthly' && (
                <div className="space-y-6">
                  <div className="bg-white rounded-lg shadow-sm p-6">
                    <div className="flex justify-between items-center mb-6">
                      <h2 className="text-2xl font-bold text-gray-900">Monthly Snapshot</h2>
                      <input type="month" value={selectedMonth}
                        onChange={(e)=> setSelectedMonth(e.target.value)}
                        className="px-4 py-2 border rounded-lg"/>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      {monthlySnapshot().map(d => (
                        <div key={d.id} className="border rounded-lg p-4">
                          <div className="flex justify-between items-start mb-3">
                            <div>
                              <h3 className="font-semibold text-gray-900">{d.name}</h3>
                              <p className="text-sm text-gray-600">{d.manager}</p>
                            </div>
                            <StatusPill status={d.status}/>
                          </div>

                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm text-gray-600">Updates Posted</span>
                              <span className="font-semibold">{d.monthlyStats.updates}</span>
                            </div>
                            <div className="flex justify-between items-center">
                              <span className="text-sm text-gray-600">Projects</span>
                              <span className="font-semibold">{d.monthlyStats.projectsCompleted}/{d.monthlyStats.projectsTotal}</span>
                            </div>
                            <div className="flex justify-between items-center">
                              <span className="text-sm text-gray-600">Avg Completion</span>
                              <div className="flex items-center gap-1">
                                <span>{d.monthlyStats.avgCompletion>70 ? "üìà" : d.monthlyStats.avgCompletion>40 ? "‚ûñ" : "üìâ"}</span>
                                <span className="font-semibold">{d.monthlyStats.avgCompletion}%</span>
                              </div>
                            </div>
                            <div className="flex justify-between items-center">
                              <span className="text-sm text-gray-600">Active Blockers</span>
                              <span className={`font-semibold ${d.monthlyStats.blockerCount>0?'text-red-600':'text-green-600'}`}>{d.monthlyStats.blockerCount}</span>
                            </div>
                          </div>

                          <div className="mt-3 pt-3 border-t">
                            {d.monthlyStats.avgCompletion>70 && d.monthlyStats.blockerCount===0 ? (
                              <div className="flex items-center gap-1 text-green-600">
                                <span>üèÖ</span><span className="text-xs font-medium">High Performer</span>
                              </div>
                            ) : d.monthlyStats.updates < 2 ? (
                              <div className="flex items-center gap-1 text-yellow-600">
                                <span>‚ö†Ô∏è</span><span className="text-xs font-medium">Needs More Updates</span>
                              </div>
                            ) : (
                              <div className="flex items-center gap-1 text-blue-600">
                                <span>üìä</span><span className="text-xs font-medium">On Track</span>
                              </div>
                            )}
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Roll-up */}
                    <div className="mt-6 pt-6 border-t">
                      <h3 className="text-lg font-semibold mb-4">Overall Performance</h3>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        {(() => {
                          const snap = monthlySnapshot();
                          const totalUpdates = snap.reduce((s,d)=>s+d.monthlyStats.updates,0);
                          const totalCompleted = snap.reduce((s,d)=>s+d.monthlyStats.projectsCompleted,0);
                          const avgCompletion = Math.round(snap.reduce((s,d)=>s+d.monthlyStats.avgCompletion,0)/departments.length || 0);
                          const totalBlockers = snap.reduce((s,d)=>s+d.monthlyStats.blockerCount,0);
                          return (
                            <>
                              <div className="bg-gray-50 rounded-lg p-4">
                                <p className="text-sm text-gray-600">Total Updates</p>
                                <p className="text-2xl font-bold text-gray-900">{totalUpdates}</p>
                              </div>
                              <div className="bg-gray-50 rounded-lg p-4">
                                <p className="text-sm text-gray-600">Projects Completed</p>
                                <p className="text-2xl font-bold text-gray-900">{totalCompleted}</p>
                              </div>
                              <div className="bg-gray-50 rounded-lg p-4">
                                <p className="text-sm text-gray-600">Avg Completion Rate</p>
                                <p className="text-2xl font-bold text-gray-900">{avgCompletion}%</p>
                              </div>
                              <div className="bg-gray-50 rounded-lg p-4">
                                <p className="text-sm text-gray-600">Total Blockers</p>
                                <p className="text-2xl font-bold text-gray-900">{totalBlockers}</p>
                              </div>
                            </>
                          );
                        })()}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Export */}
              <div className="mt-6 text-center">
                <button
                  onClick={() => {
                    const dataStr = JSON.stringify(departments, null, 2);
                    const uri = 'data:application/json;charset=utf-8,'+encodeURIComponent(dataStr);
                    const name = `ceo-dashboard-${new Date().toISOString().split('T')[0]}.json`;
                    const a = document.createElement('a');
                    a.href = uri; a.download = name;
                    document.body.appendChild(a); a.click(); a.remove();
                  }}
                  className="text-sm text-gray-500 hover:text-gray-700"
                >
                  Export Data (JSON)
                </button>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<CEODashboard />);
    </script>
  </body>
</html>
